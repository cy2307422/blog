# 大学生创新性实验成果
(2011.06开始调研，2012.06立项)
## 摘要
由于我国出租车的空驶率及乘客打的难的问题较为严重，近年来以GPS、GIS和无线通讯技术的车辆调度系统的研究和应用得到发展，但因其局限性未能很好的解决这一问题。以新兴智能终端android为平台的手机打的软件，为此类问题提供了新的解决方法，本文基于当前流行手机平台android，主要介绍此类应用的手机软件的开发步骤及相关方法。
## 关键字 android 出租车 地图
## 引言
目前我国出租车的空驶率高于世界平均水平30%以上，所以关于出租车智能调度的应用很多，但是大部分都是电召。[1]电召解决了出租车行业的一部分问题，但同时也存在着很多问题，比如司机或乘客失约问题，还有在高峰期难以顺利进行电召等问题，导致电召出租车服务一直难以火起来。除电召外，近年来以GPS、GIS和无线通讯技术的车辆调度系统的研究和应用也有了很大的发展，但大部分都需要第三方调度人员或者需要司机购买车载终端，增加了司机方的开支，所以这样的应用一般市场比较小，难以在出租车行业推广。[2]-[4]近些年来，随着android手机平台的普及，人们开始利用android手机打的软件进行解决打的难问题的尝试，该类软件应包括注册、登录、地图查看、交通信息查看、乘车请求、接送通知等基本功能。

Android是一种基于Linux的自由及开放源代码的操作系统，主要使用于移动设备，如智能手机和平板电脑，由Google公司和开放手机联盟领导及开发。目前全世界采用这款系统的设备数量已经达到10亿台。Android的系统架构和其操作系统一样，采用了分层的架构。

对于此应用来说，在应用程序框架层进行开发，应尽可能考虑司机驾驶和乘客等待的现实性，极大简化乘客和司机的操作难度，主要设计考虑如下几点：
○1采用无人值守模式，彻底突破传统的第三方调度方式。与普通的出租车电召系统不同，该系统为司机提供了一定距离和时间范围内乘客的位置信息，让司机主动了解乘客的位置分布信息，司机能主动的选择要接的乘客，而不是被动的被第三方调度人员召唤。这样就给予了司机更多的主动权，更人性化，节省人力、物力、财力，更利于该应用软件的推广。
○2基于Android，大有发展前景。大量文献资料显示，智能移动终端的普及是一个必然趋势，我们的终端有非常值得信赖的使用前景。与平常的基于GPS、GIS和无线通讯技术的车辆调度系统不同，此系统是基于Android手机的应用，不需要司机和乘客购买专门的用户终端，降低了门槛，使得司机和乘客的使用成本大大降低。
○3利用软件运行产生的海量数据，对用户的使用习惯，优化路线选择等方面进行数据分析挖掘。
○4可考虑融合语音输入功能，极大程度方便乘客与司机使用。
## 系统架构
基于Android的P2P智能移动点召手机应用分为乘客端、机端及服务器端，如图1。

<img src="https://github.com/cy2307422/blog/blob/master/flowchart.png" width="400" hegiht="650"/>


乘客端包括：目的地选择，乘车请求发送，司机评分系统，结果反馈显示等功能。乘客在进行发送乘车请求前，可以进行目的地选择；请求发送后，可若有司机进行接送，可接收到来自服务器发送的司机理论到达时间；乘车完成后，再对司机进行司机服务态度、满意度等方面进行评分。
司机端包括：搜索乘客，选择要接送的乘客，乘客信誉系统，结果反馈显示等功能。司机在空车时，可进行乘客搜索，可以进行搜索范围的选择，接到乘客后进行乘客信誉度的评价。
无人监守服务器端：该服务器承载了数据库，可进行乘客与司机的地理位置信息的增删改查。并可对超时失效综合分析模型和智能分析模型进行运算，将结果反馈给乘客或司机。
## 系统实现
### 客户端MVC模型
本软件采用开发软件环境为WinXp，开发工具为Eclipse4.0+AndroidSDK+MySQL5.0+Apache HTTP Server2.2.4+PHP5.0，地图采用高德地图android SDK2.0。
系统客户端采用MVC模式进行应用程序的开发。MVC (Model-View-Controller)是一种软件设计模式,其中M是指逻辑模型,V是指视图模型,C则是控制器,即MVC软件架构的三个基本组成部分。[7]在Android中,M指的是应用程序中的二进制的数据，V指的是用户界面,Android中通常将其直接采用XML文件保存,方便界面开发，C指Activity,一个Activity可以有多个界面,通过setContentView将视图ID传递出去,就可以指定以那个视图模型进行数据显示。釆用MVC模式,最大的好处是实现了逻辑模型开发视图模型开发的完全分离,有利于代码的重用及开发速度的提高。
基于Android的出租车打的软件设计,遵循MVC模式进行开发,提高了代码的重复使用率。例如设计好一个Layout布局后,不同的视图都可以调用这个布局,使得不同的视图得到相同的布局显示。Eclipse开发环境下Android应用程序的整个软件项目的结构见图3。
<div>
<img src="https://github.com/cy2307422/blog/blob/master/softwareStruct.png" width="400" hegiht="650" />
</div>
### 登陆注册
当用户安装完本应用后，进入会有一个欢迎界面，2秒后自动跳转进入登陆界面。在登陆之前，用户需要先注册，按要求注册完毕会自动跳转到登陆界面进行登陆。如图。
<div align="left">
  <img src="https://github.com/cy2307422/blog/blob/master/login.png" width="200" hegiht="650" />
  <img src="https://github.com/cy2307422/blog/blob/master/register.png" width="200" hegiht="650" />
</div>
### 地图界面
乘客端和司机端进行登陆后均会进入地图界面，进行自动定位，应用会调用GPS和网络混合定位模式进行定位，并将用户（乘客或司机）当前位置进行标注显示。可点击调用菜单使用其他功能，显示周围乘客（司机端）、查看周围司机（乘客端）、显示交通状况、对乘客进行排序（司机端）、选择合适乘客（司机端），接受司机接送请求（乘客端）。如图
 <div align="left">
  <img src="https://github.com/cy2307422/blog/blob/master/main.png" width="200" hegiht="400">
  <img src="https://github.com/cy2307422/blog/blob/master/map.png" width="200" hegiht="400">
  <img src="https://github.com/cy2307422/blog/blob/master/confirm.png" width="200" hegiht="400">
</div>


### 服务器端
本文以当前流行智能手机平台android为基础，阐述了出租车软件的实现过程，包括登陆、注册、地图查看、交通视图、搜索乘客/司机，发送/接受接送请求等功能模块，客户端到服务器端、数据库的构建等。基本实现了乘客打的请求，司机寻求乘客等功能。但是也存在一些问题，如司机端对于乘客的质量评价模型不够精确，只考虑了距离，在后期研究中应考虑更多的因素，结果会更具参考性。对乘客的失约行为的控制，信誉度机制还未加入等问题在后期的工作中都应再详细考虑。
<div>
<img src="https://github.com/cy2307422/blog/blob/master/server.png" width="400" hegiht="650"/>
</div>
### 总结
本文以当前流行智能手机平台android为基础，阐述了出租车软件的实现过程，包括登陆、注册、地图查看、交通视图、搜索乘客/司机，发送/接受接送请求等功能模块，客户端到服务器端、数据库的构建等。基本实现了乘客打的请求，司机寻求乘客等功能。但是也存在一些问题，如司机端对于乘客的质量评价模型不够精确，只考虑了距离，在后期研究中应考虑更多的因素，结果会更具参考性。对乘客的失约行为的控制，信誉度机制还未加入等问题在后期的工作中都应再详细考虑。
